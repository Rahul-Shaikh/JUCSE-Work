package travel;

import java.sql.*;

public class DAO {
	
	private Connection con;
	private Statement stmt;
	private String url,uname,password;
	
	public DAO(String url, String uname, String password)
	{
		this.url=url;
		this.uname=uname;
		this.password=password;
	}
	
	//Function to establish the connection
	private void setConnection() throws ClassNotFoundException, SQLException
	{
		Class.forName("com.mysql.jdbc.Driver");
		con=DriverManager.getConnection(url,uname,password);
		stmt=con.createStatement(); 
	}
	
	//Function to close the connection
	private void closeConn() throws SQLException
	{
		con.close();
	}
	
	//Function for getting cities
	public ResultSet getCities() throws ClassNotFoundException, SQLException
	{
		setConnection();
		String query="select * from cities";
		ResultSet rs=stmt.executeQuery(query);
		
		if(rs.next())
		{
			return rs;
		}
		closeConn();
		return null;
	}
	
	//Function for getting flights 
	public ResultSet getFlights(String src, String dest, String day) throws ClassNotFoundException, SQLException
	{
		setConnection();
		String query="select * from flights where src_sity=\'"+src+"\' and dest_city=\'"+dest+"\' and day=\'"+day+"\'";
		ResultSet rs=stmt.executeQuery(query);
		
		if(rs.next())
		{
			return rs;
		}
		closeConn();
		return null;
	}
//	
//	//Function for registering
//	public void register(User u) throws ClassNotFoundException, SQLException
//	{
//		setConnection();
//		String query="insert into logininfo values('"+u.getName()+"','"+u.getGender()+"','"+u.getUname()+"','"+u.getPassword()+"','"+u.getChoice()+"')";
//		int res=stmt.executeUpdate(query);
//		closeConn();
//		
//	}
//	
//	//Function for fetching data from items table
//	public ResultSet getItems(User u) throws ClassNotFoundException, SQLException
//	{
//		setConnection();
//		String query="select * from items where gender='"+u.getGender()+"'";
//		
//		if(u.getChoice().equals("newarr"))
//			query+=" order by itemtype desc";
//		else
//			query+=" order by itemtype asc, discount desc";
//		
//		System.out.println(query);
//		ResultSet rs=stmt.executeQuery(query);
//		
////		while(rs.next())
////			System.out.println(rs.getString("name"));
////		
////		System.out.println(rs);
//		if(rs.next())
//		{
//			return rs;
//		}
//		closeConn();
//		return null;
//	}
//	
//	//Function for fetching data from items table
//		public ResultSet getItemsByName(String name) throws ClassNotFoundException, SQLException
//		{
//			setConnection();
//			String query="select * from items where name='"+name+"'";
//			
//			System.out.println(query);
//			ResultSet rs=stmt.executeQuery(query);
//			
////			while(rs.next())
////				System.out.println(rs.getString("name"));
////			
////			System.out.println(rs);
//			if(rs.next())
//			{
//				return rs;
//			}
//			closeConn();
//			return null;
//		}
//	
//	public void updatePass(String username, String pass) throws ClassNotFoundException, SQLException
//	{
//		setConnection();
//		String query="update logininfo set password='"+pass+"' where uname='"+username+"'";
//		int res=stmt.executeUpdate(query);
//		closeConn();
//	}
	
}
